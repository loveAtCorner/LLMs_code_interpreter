{
    "model": "qwen1.5-32b-chat-int4",
    "messages": [
        {
            "role": "system",
            "content": "你是python源码结构和逻辑的解析专家，非常擅长剖析核心代码的功能"
        },
        {
            "role": "user",
            "content": "请概括下面这个脚本的核心功能，然后该功能是否和大语言模型的指令精调任务有关```python\nfrom types import MethodType\nfrom typing import TYPE_CHECKING, Optional\n\nfrom transformers import Trainer\n\nfrom ...extras.logging import get_logger\nfrom ..callbacks import PissaConvertCallback, SaveProcessorCallback\nfrom ..trainer_utils import create_custom_optimzer, create_custom_scheduler\n\n\nif TYPE_CHECKING:\n    import torch\n    from transformers import ProcessorMixin\n\n    from ...hparams import FinetuningArguments\n\n\nlogger = get_logger(__name__)\n\n\nclass CustomTrainer(Trainer):\n    r\n\n    def __init__(\n        self, finetuning_args: \"FinetuningArguments\", processor: Optional[\"ProcessorMixin\"], **kwargs\n    ) -> None:\n        super().__init__(**kwargs)\n        self.finetuning_args = finetuning_args\n\n        if processor is not None:\n            self.add_callback(SaveProcessorCallback(processor))\n\n        if finetuning_args.pissa_convert:\n            self.add_callback(PissaConvertCallback)\n\n        if finetuning_args.use_badam:\n            from badam import BAdamCallback, clip_grad_norm_old_version\n\n            self.accelerator.clip_grad_norm_ = MethodType(clip_grad_norm_old_version, self.accelerator)\n            self.add_callback(BAdamCallback)\n\n    def create_optimizer(self) -> \"torch.optim.Optimizer\":\n        if self.optimizer is None:\n            self.optimizer = create_custom_optimzer(self.model, self.args, self.finetuning_args)\n        return super().create_optimizer()\n\n    def create_scheduler(\n        self, num_training_steps: int, optimizer: Optional[\"torch.optim.Optimizer\"] = None\n    ) -> \"torch.optim.lr_scheduler.LRScheduler\":\n        create_custom_scheduler(self.args, num_training_steps, optimizer)\n        return super().create_scheduler(num_training_steps, optimizer)\n```"
        }
    ],
    "temperature": 0
}